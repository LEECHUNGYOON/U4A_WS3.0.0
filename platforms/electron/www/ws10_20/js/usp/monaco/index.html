<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Monaco Editor</title>
    <style>
        html,
        body,
        #container {
            margin: 0;
            height: 100%;
        }
    </style>

    <style>
        .my-icon-gutter {
            background: url('dddd.png') no-repeat center center;
            /* background-size: contain;
    width: 16px;
    height: 16px; */
            background-size: 24px 24px;
        }

        .my-line-highlight {
            background-color: yellow !important;
            opacity: 0.1;
            color: red !important;
            font-weight: bold;
        }
    </style>


    <style>
        html,
        body {
            height: 100%;
            margin: 0;
            overflow: hidden;
        }

        #split-container {
            display: flex;
            flex-direction: row;
            /* ìˆ˜í‰ ë¶„í•  */
            height: 100%;
            width: 100%;
        }

        #editor-left,
        #editor-right {
            flex: 1;
            height: 100%;
        }

        #editor-left {
            border-right: 1px solid #444;
        }
    </style>

    <style>
        /* ê³µí†µ ìŠ¤í¬ë¡¤ë°” ì„¤ì • */
        .monaco-scrollable-element>.scrollbar {
            background: transparent !important;
            z-index: 10;
        }

        .monaco-scrollable-element>.scrollbar>.slider {
            background: rgba(128, 128, 128, 0.3) !important;
            /* íšŒìƒ‰ & íˆ¬ëª…ë„ */
            border-radius: 4px !important;
            transition: opacity 0.2s;
        }

        /* ìŠ¤í¬ë¡¤ë°” ê¸°ë³¸ì€ ìˆ¨ê¹€ */
        .monaco-scrollable-element>.scrollbar>.slider {
            opacity: 0;
        }

        /* ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ ë‚˜íƒ€ë‚¨ */
        .monaco-scrollable-element:hover>.scrollbar>.slider {
            opacity: 1;
        }

        /* ì‚¬ì´ì¦ˆ ì¡°ì ˆ */
        .monaco-scrollable-element>.scrollbar.vertical {
            width: 6px !important;
        }

        .monaco-scrollable-element>.scrollbar.horizontal {
            height: 6px !important;
        }
    </style>


    <script>

/****************************************************************************
 * ğŸ”¥ Global Variables
 ****************************************************************************/
        const
            oAPP = {};
            oAPP.params = {};
            oAPP.attr = {};

        // ë¶€ëª¨ì˜ ë¶€ëª¨ ê°ì²´(í• ì•„ë²„ì§€ ê°ì²´)
        const GRAND_FATHER = parent.parent;

        // URL ê°ì²´
        const oURL = new URL(location.href);

        // URLì— ìˆëŠ” QueryString íŒŒë¼ë¯¸í„° ê°ì²´
        const oSearchParams = oURL.searchParams;



        // ìŠ¤ë‹ˆí« ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ì „ì—­ ë³€ìˆ˜
        oAPP.attr.aSnippetData = [];



/****************************************************************************
 * ğŸ”¥ Npm Library
 ****************************************************************************/        
        const PATH = GRAND_FATHER.PATH;
        const FS   = GRAND_FATHER.FS;


        
/****************************************************************************
 * ğŸ”¥ Paths
 ****************************************************************************/

        // USP root ê²½ë¡œ
        const USP_ROOT_PATH = GRAND_FATHER.PATHINFO.USP_ROOT;


        // ëª¨ë‚˜ì½” ì—ë””í„° ê´€ë ¨ ê²½ë¡œ
        const MONACO_LIB_PATH = PATH.join(GRAND_FATHER.APPPATH, "lib", "monaco");
        const MONACO_VS_ROOT_PATH = PATH.join(MONACO_LIB_PATH, "vs");
        const MONACO_LOADER_PATH  = PATH.join(MONACO_VS_ROOT_PATH, "loader.js");
        



        // URL QueryString ì •ë³´ë¥¼ íŒŒë¼ë¯¸í„° ê°ì²´ì— ì €ì¥í•œë‹¤.
        oAPP.params = oSearchParams;

        // ì „ë‹¬ë°›ì€ íŒŒë¼ë¯¸í„° (JSON Stringify Data)
        let sPARAMS = oAPP.params.get("PARAMS");

        // ì „ë‹¬ë°›ì€ íŒŒë¼ë¯¸í„°ë¥¼ ê°ì²´í™” 
        let oPARAMS = JSON.parse(sPARAMS);

        // í˜„ì¬ í˜ì´ì§€ì˜ ID ì •ë³´ë¥¼ ì €ì¥í•´ ë‘”ë‹¤.
        oAPP.attr.PAGEID = oPARAMS.PAGEID;

        // í˜„ì¬ BROWSKEY ì •ë³´ë¥¼ ì €ì¥í•´ë‘”ë‹¤.
        oAPP.attr.BROWSKEY = GRAND_FATHER.getBrowserKey();

        // ë¶€ëª¨ì™€ í†µì‹ í•˜ê¸° ìœ„í•œ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ìš© DOM
        let sCustDomId = "IF_USP_EDITOR";

        oAPP.attr.oCustomEvtDom = parent.document.getElementById(sCustDomId);




        // ì´ë¯¸ ì˜ˆì•½ëœ ë‹¨ì¶•í‚¤ ëª©ë¡ ì •ë³´ êµ¬í•˜ê¸°
        let aReservedShortcutList = GRAND_FATHER.require(GRAND_FATHER.PATH.join(USP_ROOT_PATH, "monaco", "shortcut", "reservedShortcutList.json"));

        
        function onLoad() {

            var loaderScript = document.createElement('script');
            loaderScript.src = 'index.js'; // â† ê²½ë¡œ ì •í™•íˆ

            document.head.append(loaderScript);
        };

        // onMessageì—ì„œ Action ì½”ë“œê°€ Init ì¼ ê²½ìš° í˜¸ì¶œë˜ëŠ” function
        function onMessageInit(oParams) {

            if (typeof oParams?.port === "undefined") { return; }

            console.log("onMessageInit");

            oAPP.MESSAGE_CHANEL_PORT = oParams.port;

            oAPP.MESSAGE_CHANEL_PORT.onmessage = (oEvent) => {

                // ì™¸ë¶€ì—ì„œ ì—ë””í„° ë°ì´í„° ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸ í–ˆë‹¤ëŠ” í”Œë˜ê·¸ë¥¼ ì„¤ì •í•œë‹¤.
                editor.bExternalUpdated = true;

                editor.setValue(oEvent.data);

            };

        } // end of onMessageInit


        // onMessageì—ì„œì˜ í…Œë§ˆ ì ìš© ë©”ì†Œë“œ
        function onApplyTheme(oParams){
            
            if(!oParams){
                return;
            }

            let oThemeInfo = oParams?.oThemeInfo || undefined;
            if(!oThemeInfo){
                return;
            }

            let sThemeName = oThemeInfo?.themeName || "";
            if(!sThemeName){
                return;
            }

            // í…Œë§ˆ ì ìš©í•˜ê¸°
            setApplyTheme(sThemeName);

        }

        // í…Œë§ˆ ì ìš©í•˜ê¸°
        function setApplyTheme(sThemeName){

            let oThemeData = GRAND_FATHER.WSUTIL.MONACO_EDITOR.getThemeInfo(sThemeName);
            if(!oThemeData){
                return;
            }

            let oThemeInfo = oThemeData?.themeInfo || undefined;
            if(!oThemeInfo){
                return;
            }


            // í…Œë§ˆ ì„ ì–¸
            monaco.editor.defineTheme(sThemeName, oThemeInfo);

            // í…Œë§ˆ ë³€ê²½
            monaco.editor.setTheme(sThemeName);

        }

        window.addEventListener('message', (oEvent) => {

            // íŒŒë¼ë¯¸í„°ê°€ ì—†ì„ ê²½ìš° ë¹ ì ¸ë‚˜ê°
            let oParams = oEvent?.data || undefined;
            if(!oParams){
                return;
            }

            // ì•¡ì…˜ì½”ë“œê°€ ì—†ë‹¤ë©´ ë¹ ì ¸ë‚˜ê°
            let sActcd = oParams?.actcd || "";
            if(!sActcd){
                return;
            }

            // ì „ë‹¬ë°›ì€ íŒŒë¼ë¯¸í„° ì¤‘, ACTION CODE(actcd) ë³„ í”„ë¡œì„¸ìŠ¤ ë¶„ê¸°
            switch (sActcd) {
                case "init":

                    // onMessageInit(oEvent);
                    onMessageInit(oParams);

                    return;

                case "applyTheme":  // í…Œë§ˆ ì ìš©
                    
                    // onApplyTheme(oEvent.data);
                    onApplyTheme(oParams);

                    return;

                default:
                    break;
            }

        });

        window.addEventListener("DOMContentLoaded", function () {
          
            var loaderScript = document.createElement('script');
            loaderScript.src = MONACO_LOADER_PATH;

            document.head.append(loaderScript);

            loaderScript.onload = onLoad;


            // let oMsgEvt = new MessageEvent("IF_USP_EDITOR", { data: { ACTCD: "ON_LOAD" } });
            // if(oAPP.attr.oCustomEvtDom){
            //     oAPP.attr.oCustomEvtDom.dispatchEvent(oMsgEvt);
            // }

            // // Shortcut ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ
            // let sShortCutJsPath = GRAND_FATHER.PATH.join(GRAND_FATHER.APPPATH, "js", "shortcut.js");	 
            // var loaderScript = document.createElement('script');
            // 	loaderScript.src = sShortCutJsPath

            // document.head.append(loaderScript);


        });

        window.onload = function () {

            // // USP Shortcut ë“±ë¡
            // var aShortcutList = parent.oAPP.common.getShortCutList("WS30"),
            //     iLength = aShortcutList.length;

            // for (var i = 0; i < iLength; i++) {

            //     var oShortcutInfo = aShortcutList[i];

            //     shortcut.add(oShortcutInfo.KEY, oShortcutInfo.fn);

            // }

        }

    </script>


    <!-- <script src="./lib/monaco/vs/loader.js" onload="onLoad()" ></script> -->
    <!-- <script src="./lib/monaco/vs/loader.js" onload="onLoad();"></script> -->
    <!-- <script src="" onload="onLoad();"></script> -->


    <!-- <script src="monaco.js"></script> -->

</head>

<body>

    <div id="content" style="height:100%;"></div>
    <!-- <div id="split-container">
    <div id="editor-left"></div>
    <div id="editor-right"></div>
  </div> -->

    <!-- <div id="container"></div> -->

    <!-- <div id="custom-tooltip" style="
    display: none;
    position: absolute;
    background: #333;
    color: white;
    padding: 8px;
    border-radius: 4px;
    font-size: 12px;
    max-width: 300px;
    z-index: 9999;
    box-shadow: 2px 2px 6px rgba(0,0,0,0.2);
  "></div> -->

</body>

</html>